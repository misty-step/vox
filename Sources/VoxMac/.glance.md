## Purpose
This directory provides macOS-specific infrastructure for audio capture, processing, and user interface. it manages hardware interactions through CoreAudio and AVFoundation, handles secure storage via Keychain, and implements a system-wide HUD and hotkey monitoring. The components support the full lifecycle of a dictation event, from recording and encryption to clipboard-based text insertion.

## Key Roles
- **AudioRecorder.swift**: Orchestrates audio capture using `AVAudioEngine` or `AVAudioRecorder` with real-time level monitoring and PCM conversion.
- **AudioDeviceManager.swift**: Interfaces with CoreAudio to list, observe, and select system audio input devices.
- **AudioFileEncryption.swift**: Provides AES-GCM encryption and decryption for audio files using `CryptoKit` and chunk-based processing.
- **AudioEncoder.swift**: Utilizes the `afconvert` system utility to encode audio files into Opus-in-CAF format.
- **HUDController.swift & HUDView.swift**: Manage a floating SwiftUI-based "Heads-Up Display" (HUD) that persists its window position and reflects recording states.
- **ClipboardPaster.swift**: Handles text insertion by manipulating the system pasteboard and simulating paste keystrokes via AppleScript or `CGEvent`.
- **HotkeyMonitor.swift**: Registers and manages system-wide hotkeys through the Carbon framework.
- **KeychainHelper.swift**: Manages secure storage and retrieval of API keys for external services like ElevenLabs and Deepgram.
- **PermissionManager.swift**: Validates and requests system permissions for microphone access and accessibility features.

## Dependencies and Caveats
- Requires `CoreAudio`, `AVFoundation`, and `AudioToolbox` for audio hardware and processing.
- Uses the `afconvert` system utility located at `/usr/bin/afconvert` for Opus encoding.
- Relies on the `Carbon` framework for global hotkey registration and event handling.
- Encryption uses `CryptoKit` with AES-GCM and a custom `VOXENC1` file header.
- Clipboard pasting requires Accessibility permissions and uses AppleScript as the primary method for triggering Cmd+V.
- Supports two recording backends selectable via the `VOX_AUDIO_BACKEND` environment variable.
- Per-app audio routing is opt-in via the `VOX_ENABLE_PER_APP_AUDIO_ROUTING` environment variable.
- HUD position persistence is managed via `UserDefaults` using the `HUDWindowPosition` key.