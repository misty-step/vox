## Purpose
This directory provides a diagnostic and performance tracking framework for the Vox application. It facilitates the recording of structured events, manages local log rotation in JSONL format, and supports exporting diagnostic bundles as ZIP archives. The framework also includes specialized logic for mapping internal errors to diagnostic codes and capturing application state.

## Key Roles
- `DiagnosticsStore`: An actor that manages local event logging, file rotation, and the generation of diagnostic ZIP exports using system utilities.
- `PerformanceIngestClient`: An actor responsible for buffering and asynchronously uploading allowlisted performance events to a remote endpoint.
- `ProductInfo`: A utility for resolving application metadata, such as version and build numbers, from the bundle information or environment variables.
- `DiagnosticsContext`: A structure that captures the current application state, including OS version, STT routing configurations, and the presence of API keys.
- `DiagnosticsEvent` and `DiagnosticsValue`: Data structures defining the schema for structured diagnostic entries and their associated metadata.

## Dependencies and Caveats
- Depends on `VoxCore` for error types and preference management.
- Uses the system utility `/usr/bin/ditto` via `Process` to create ZIP archives for diagnostic exports.
- `PerformanceIngestClient` is active only when the `VOX_PERF_INGEST_URL` environment variable is defined.
- Telemetry uploads are restricted to an allowlist of event names: `pipeline_timing` and `share_trigger`.
- Local logs are stored in the application support directory and are subject to rotation based on file size and count.
- Error reporting includes specific diagnostic payloads for `AudioConversionError`, including exit codes and tool information.
- The framework resolves configuration flags like `VOX_STT_ROUTING` and `VOX_AUDIO_BACKEND` from the process environment.